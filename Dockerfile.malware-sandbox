# Hardened Malware Analysis Sandbox
FROM python:3.12-slim

LABEL maintainer="nautilus-dev"
LABEL description="Hardened sandbox for malware analysis"

# Create restricted user
RUN groupadd -r analyzer && useradd -r -g analyzer -s /usr/sbin/nologin analyzer

# Install analysis tools
RUN pip install --no-cache-dir \
    bandit \
    safety \
    && rm -rf /root/.cache

# Create analysis directories
RUN mkdir -p /analysis/input /analysis/output \
    && chown -R analyzer:analyzer /analysis

WORKDIR /analysis

# Switch to restricted user
USER analyzer

# No shell access
SHELL ["/bin/false"]

# Default: run analysis
ENTRYPOINT ["python", "-m", "bandit"]
CMD ["-r", "/analysis/input", "-f", "json", "-o", "/analysis/output/report.json"]
